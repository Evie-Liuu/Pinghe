import{_ as I,a as S}from"./lightBulb2-C7D1_u2a.js";import{_ as z}from"./HeaderFilter-ByfYTs0k.js";import{j as A,a as x,o as c,F as P,p as C,b as e,h as i,f as u,g as o,t as g,s as N,n as L,q as _,x as F,y as B,c as h,d as V,u as q,r as D,k as E,l as H,i as M,z as U,A as R}from"./index-BmgCHQXP.js";import{C as w}from"./CJKSub-_ZFMku1E.js";import{s as J}from"./SDGs_goal-BU-5yG0n.js";import{T as K}from"./TrainTrack-BHLwwOZ_.js";const G=["onClick"],O={class:"p-4 md:p-10 flex flex-col justify-center w-full md:flex-1 text-sm md:text-lg"},Q={class:"text-xl md:text-2xl mb-2 md:mb-2"},W={class:"grid grid-cols-1 md:grid-cols-2 gap-x-4"},X={class:"mb-2"},Y={class:"text-md mb-2"},Z={class:"text-md mb-2 md:col-span-2"},ee={class:"flex items-center w-full md:w-70 gap-3 md:col-span-2"},te={class:"relative flex-1 bg-gray-200 rounded-full h-2 overflow-hidden"},se={class:"w-10 text-sm text-gray-700 text-left"},le={class:"flex flex-wrap gap-2 mt-2 md:col-span-2"},ae={__name:"ActionCard",props:{filteredInfo:{type:Array,default:()=>[]}},setup(f){const y=A(),d=l=>l<40?"bg-red-500":l<70?"bg-yellow-400":"bg-green-500",v=l=>{y.push({name:"action-detail",params:{id:l}})};return(l,t)=>(c(),x("div",F(B(l.$attrs)),[(c(!0),x(P,null,C(f.filteredInfo,a=>(c(),x("div",{class:"bg-gradient-to-r from-gray-800/40 to-gray-400/20 backdrop-blur-sm animate-fade-in-up cursor-pointer w-full md:max-w-7xl md:max-h-95 rounded-xl hover:shadow-focus overflow-hidden flex flex-col md:flex-row hover:scale-105",key:a.id,onClick:p=>v(a.id)},[t[11]||(t[11]=e("div",{class:"w-full md:w-2/5 flex items-end justify-center md:justify-end"},[e("img",{src:I,alt:"Card Image",class:"w-full h-full object-cover object-center rounded-xl"})],-1)),e("div",O,[e("h2",Q,[e("span",null,[u(w,{align:"center"},{zh:o(()=>[...t[0]||(t[0]=[e("span",{class:"text-xl md:text-2xl"},"主題",-1)])]),en:o(()=>[...t[1]||(t[1]=[i("Issue",-1)])]),_:1})]),i(" ："+g(a.title),1)]),e("div",W,[e("p",X,[u(w,{align:"center"},{zh:o(()=>[...t[2]||(t[2]=[e("span",{class:"text-lg md:text-xl"},"時間",-1)])]),en:o(()=>[...t[3]||(t[3]=[i("Time",-1)])]),_:1}),i(" ："+g(a.startTime&&a.endTime?new Date(a.startTime*1e3).toLocaleDateString()+" ~ "+new Date(a.endTime*1e3).toLocaleDateString():"無"),1)]),e("p",Y,[u(w,{align:"left"},{zh:o(()=>[...t[4]||(t[4]=[e("span",{class:"text-lg md:text-xl"},"成員",-1)])]),en:o(()=>[...t[5]||(t[5]=[i("Member",-1)])]),_:1}),i(" ："+g(a.group),1)]),e("p",Z,[u(w,{align:"left"},{zh:o(()=>[...t[6]||(t[6]=[e("span",{class:"text-lg md:text-xl"},"描述",-1)])]),en:o(()=>[...t[7]||(t[7]=[i("Description",-1)])]),_:1}),i(" ："+g(a.intro),1)]),e("div",ee,[u(w,{align:"left"},{zh:o(()=>[...t[8]||(t[8]=[e("span",{class:"text-lg md:text-xl"},"進度",-1)])]),en:o(()=>[...t[9]||(t[9]=[i("Progress",-1)])]),_:1}),t[10]||(t[10]=i(" ： ",-1)),e("div",te,[e("div",{class:L(["h-2 rounded-full transition-all duration-500",d(a.progress)]),style:N({width:a.progress+"%"})},null,6)]),e("span",se,g(a.progress)+"% ",1)]),e("div",le,[(c(!0),x(P,null,C(a.sdgs_goals,p=>(c(),x("span",{key:p,class:"px-3 py-1 text-sm rounded-full bg-blue-100 text-blue-800"},g(_(J)[p].title),1))),128))])])])],8,G))),128))],16))}},re={key:0,class:"text-base md:text-[1.6rem]"},oe=["disabled"],ne=["disabled"],de={__name:"PageLabel",props:{totalItems:{type:Number,required:!0},itemsPerPage:{type:Number,default:6},modelValue:{type:Number,required:!0}},emits:["update:modelValue"],setup(f,{emit:y}){const d=f,v=y,l=h(()=>d.totalItems===0?1:Math.ceil(d.totalItems/d.itemsPerPage)),t=()=>{d.modelValue<l.value&&v("update:modelValue",d.modelValue+1)},a=()=>{d.modelValue>1&&v("update:modelValue",d.modelValue-1)};return(p,T)=>l.value>=1?(c(),x("div",re,[e("button",{onClick:a,disabled:f.modelValue===1,class:"px-4 py-2 bg-gray-300 rounded-md disabled:opacity-50"}," 上一頁 ",8,oe),e("span",null,"第 "+g(f.modelValue)+" / "+g(l.value)+" 頁",1),e("button",{onClick:t,disabled:f.modelValue===l.value,class:"px-4 py-2 bg-gray-300 rounded-md disabled:opacity-50"}," 下一頁 ",8,ne)])):V("",!0)}},ie={class:"relative z-5 pt-25 w-full shadow-md bg-header text-rice-500"},ue={class:"container mx-auto flex items-center p-4"},me={class:"w-1/3"},ce={class:"text"},pe={class:"w-1/3 flex items-center justify-end pr-4 gap-2"},ge={class:"p-10 flex flex-col justify-center items-center gap-8 max-w-7xl md:mx-auto"},xe={key:0,class:"text-center text-gray-500 mt-8"},k=3,De={__name:"Actions",setup(f){const{isTeacher:y}=q(),d=R("handleAppScroll"),v=D(S),l=D({sdgs:[],time:"all",startDate:"",endDate:"",keyword:""}),t=D(1);E(async()=>{try{let r=await H.getActivities();console.log(r)}catch(r){console.error("Failed to fetch posts:",r)}});const a=r=>{l.value=r,t.value=1},p=h(()=>{let r=v.value;if(l.value.sdgs.length>0&&(r=r.filter(s=>s.sdgs_goals&&s.sdgs_goals.some(n=>l.value.sdgs.includes(n)))),l.value.time!=="all"){const s=new Date;let n,m;switch(l.value.time){case"day":m=new Date(s),n=new Date(s),n.setDate(s.getDate()-1);break;case"week":m=new Date(s),n=new Date(s),n.setDate(s.getDate()-7);break;case"custom":l.value.startDate&&l.value.endDate&&(n=new Date(l.value.startDate),n.setHours(0,0,0,0),m=new Date(l.value.endDate),m.setHours(23,59,59,999));break}n&&m&&(r=r.filter(b=>{if(!b.startTime||!b.endTime||!String(b.startTime).trim()||!String(b.endTime).trim())return!1;const $=new Date(Number(b.startTime)*1e3),j=new Date(Number(b.endTime)*1e3);return $<=m&&j>=n}))}return l.value.keyword&&(r=r.filter(s=>s.title.toLowerCase().includes(l.value.keyword.toLowerCase()))),r}),T=h(()=>{const r=(t.value-1)*k,s=r+k;return p.value.slice(r,s)});return(r,s)=>{const n=M("router-link");return c(),x("div",{class:"page-background content-scroller",onScroll:s[1]||(s[1]=(...m)=>_(d)&&_(d)(...m))},[e("div",null,[e("header",ie,[e("div",ue,[e("div",me,[u(n,{to:"/",class:"back-home-btn"},{default:o(()=>[e("span",ce,[u(w,{align:"center"},{zh:o(()=>[...s[2]||(s[2]=[i("回首頁",-1)])]),en:o(()=>[...s[3]||(s[3]=[i("Home",-1)])]),_:1})]),s[4]||(s[4]=e("span",{class:"icon"},"←",-1))]),_:1})]),s[6]||(s[6]=e("div",{class:"w-1/3 text-center"},[e("h1",{class:"text-2xl md:text-3xl font-bold"},"行動追蹤")],-1)),e("div",pe,[_(y)?(c(),U(n,{key:0,to:"/actions/new",title:"建立新故事"},{default:o(()=>[...s[5]||(s[5]=[e("div",{class:"w-10 h-10 bg-orange-300 rounded-full flex items-center justify-center text-white cursor-pointer transition delay-150 duration-300 ease-in-out hover:-translate-y-1 hover:scale-110"},[e("i",{class:"fa-solid fa-plus font-bold text-pblue-500"})],-1)])]),_:1})):V("",!0)])])]),e("main",ge,[u(z,{"onUpdate:filters":a,class:"flex flex-wrap justify-center items-center gap-4"}),u(ae,{filteredInfo:T.value,class:"flex flex-col gap-10 w-full md:px-0"},null,8,["filteredInfo"]),p.value.length===0?(c(),x("div",xe,[...s[7]||(s[7]=[e("p",null,"找不到符合條件的行動。",-1)])])):V("",!0),u(de,{class:"flex justify-center items-center gap-4 mt-8",totalItems:p.value.length,itemsPerPage:k,modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=m=>t.value=m)},null,8,["totalItems","modelValue"]),u(K)])])],32)}}};export{De as default};
