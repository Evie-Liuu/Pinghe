import{_ as A,a as S}from"./lightBulb2-C4sSw090.js";import{_ as z}from"./HeaderFilter-DiIOhVtW.js";import{j as N,a as g,o as c,F as P,p as C,b as t,h as i,f as u,g as r,t as p,s as L,n as F,q as k,x as B,y as E,c as V,d as T,u as q,r as D,k as H,l as M,i as U,z as R,A as J}from"./index-BMdFWD3I.js";import{C as w}from"./CJKSub-CytIZdfj.js";import{s as K}from"./SDGs_goal-BU-5yG0n.js";import{T as G}from"./TrainTrack-BYWEAlS9.js";const O=["onClick"],Q={class:"p-4 md:p-10 flex flex-col justify-center w-full md:flex-1 text-sm md:text-lg"},W={class:"text-xl md:text-2xl mb-2 md:mb-2"},X={class:"grid grid-cols-1 md:grid-cols-2 gap-x-4"},Y={class:"mb-2"},Z={class:"text-md mb-2"},ee={class:"text-md mb-2 md:col-span-2"},te={class:"flex items-center w-full md:w-70 gap-3 md:col-span-2"},se={class:"relative flex-1 bg-gray-200 rounded-full h-2 overflow-hidden"},le={class:"w-10 text-sm text-gray-700 text-left"},ae={class:"flex flex-wrap gap-2 mt-2 md:col-span-2"},re={__name:"ActionCard",props:{filteredInfo:{type:Array,default:()=>[]}},setup(x){const y=N(),d=o=>o<40?"bg-red-500":o<70?"bg-yellow-400":"bg-green-500",f=o=>{y.push({name:"action-detail",params:{id:o}})};return(o,e)=>(c(),g("div",B(E(o.$attrs)),[(c(!0),g(P,null,C(x.filteredInfo,l=>(c(),g("div",{class:"bg-gradient-to-r from-gray-800/40 to-gray-400/20 backdrop-blur-sm animate-fade-in-up cursor-pointer w-full md:max-w-7xl md:max-h-95 rounded-xl hover:shadow-focus overflow-hidden flex flex-col md:flex-row hover:scale-105",key:l.id,onClick:v=>f(l.id)},[e[11]||(e[11]=t("div",{class:"w-full md:w-2/5 flex items-end justify-center md:justify-end"},[t("img",{src:A,alt:"Card Image",class:"w-full h-full object-cover object-center rounded-xl"})],-1)),t("div",Q,[t("h2",W,[t("span",null,[u(w,{align:"center"},{zh:r(()=>[...e[0]||(e[0]=[t("span",{class:"text-xl md:text-2xl"},"主題",-1)])]),en:r(()=>[...e[1]||(e[1]=[i("Issue",-1)])]),_:1})]),i(" ："+p(l.title),1)]),t("div",X,[t("p",Y,[u(w,{align:"center"},{zh:r(()=>[...e[2]||(e[2]=[t("span",{class:"text-lg md:text-xl"},"時間",-1)])]),en:r(()=>[...e[3]||(e[3]=[i("Time",-1)])]),_:1}),i(" ："+p(l.startTime&&l.endTime?new Date(l.startTime*1e3).toLocaleDateString()+" ~ "+new Date(l.endTime*1e3).toLocaleDateString():"無"),1)]),t("p",Z,[u(w,{align:"left"},{zh:r(()=>[...e[4]||(e[4]=[t("span",{class:"text-lg md:text-xl"},"成員",-1)])]),en:r(()=>[...e[5]||(e[5]=[i("Member",-1)])]),_:1}),i(" ："+p(l.group),1)]),t("p",ee,[u(w,{align:"left"},{zh:r(()=>[...e[6]||(e[6]=[t("span",{class:"text-lg md:text-xl"},"描述",-1)])]),en:r(()=>[...e[7]||(e[7]=[i("Description",-1)])]),_:1}),i(" ："+p(l.intro),1)]),t("div",te,[u(w,{align:"left"},{zh:r(()=>[...e[8]||(e[8]=[t("span",{class:"text-lg md:text-xl"},"進度",-1)])]),en:r(()=>[...e[9]||(e[9]=[i("Progress",-1)])]),_:1}),e[10]||(e[10]=i(" ： ",-1)),t("div",se,[t("div",{class:F(["h-2 rounded-full transition-all duration-500",d(l.progress)]),style:L({width:l.progress+"%"})},null,6)]),t("span",le,p(l.progress)+"% ",1)]),t("div",ae,[(c(!0),g(P,null,C(l.sdgs_goals,v=>(c(),g("span",{key:v,class:"px-3 py-1 text-sm rounded-full bg-blue-100 text-blue-800"},p(k(K)[v].title),1))),128))])])])],8,O))),128))],16))}},oe={key:0,class:"text-base md:text-[1.6rem]"},ne=["disabled"],ie=["disabled"],de={__name:"PageLabel",props:{totalItems:{type:Number,required:!0},itemsPerPage:{type:Number,default:6},modelValue:{type:Number,required:!0}},emits:["update:modelValue"],setup(x,{emit:y}){const d=x,f=y,o=V(()=>d.totalItems===0?1:Math.ceil(d.totalItems/d.itemsPerPage)),e=()=>{d.modelValue<o.value&&f("update:modelValue",d.modelValue+1)},l=()=>{d.modelValue>1&&f("update:modelValue",d.modelValue-1)};return(v,_)=>o.value>=1?(c(),g("div",oe,[t("button",{onClick:l,disabled:x.modelValue===1,class:"px-4 py-2 bg-gray-300 rounded-md disabled:opacity-50"}," 上一頁 ",8,ne),t("span",null,"第 "+p(x.modelValue)+" / "+p(o.value)+" 頁",1),t("button",{onClick:e,disabled:x.modelValue===o.value,class:"px-4 py-2 bg-gray-300 rounded-md disabled:opacity-50"}," 下一頁 ",8,ie)])):T("",!0)}},ue={class:"relative z-5 pt-25 w-full shadow-md bg-header text-rice-500"},me={class:"container mx-auto flex items-center p-4"},ce={class:"w-1/3"},pe={class:"text"},ge={class:"w-1/3 flex items-center justify-end pr-4 gap-2"},xe={class:"p-10 flex flex-col justify-center items-center gap-8 max-w-7xl md:mx-auto"},fe={key:0,class:"text-center text-gray-500 mt-8"},h=3,De={__name:"Actions",setup(x){const{isTeacher:y,user:d}=q(),f=J("handleAppScroll"),o=D(S),e=D({sdgs:[],time:"all",startDate:"",endDate:"",keyword:""}),l=D(1);H(async()=>{try{if(d.value){let a=await M.getActivities();console.log("Activities response:",a)}else console.log("No user found, skipping getActivities call")}catch(a){console.error("Failed to fetch activities:",a),console.error("Error details:",a.message)}});const v=a=>{e.value=a,l.value=1},_=V(()=>{let a=o.value;if(e.value.sdgs.length>0&&(a=a.filter(s=>s.sdgs_goals&&s.sdgs_goals.some(n=>e.value.sdgs.includes(n)))),e.value.time!=="all"){const s=new Date;let n,m;switch(e.value.time){case"day":m=new Date(s),n=new Date(s),n.setDate(s.getDate()-1);break;case"week":m=new Date(s),n=new Date(s),n.setDate(s.getDate()-7);break;case"custom":e.value.startDate&&e.value.endDate&&(n=new Date(e.value.startDate),n.setHours(0,0,0,0),m=new Date(e.value.endDate),m.setHours(23,59,59,999));break}n&&m&&(a=a.filter(b=>{if(!b.startTime||!b.endTime||!String(b.startTime).trim()||!String(b.endTime).trim())return!1;const j=new Date(Number(b.startTime)*1e3),I=new Date(Number(b.endTime)*1e3);return j<=m&&I>=n}))}return e.value.keyword&&(a=a.filter(s=>s.title.toLowerCase().includes(e.value.keyword.toLowerCase()))),a}),$=V(()=>{const a=(l.value-1)*h,s=a+h;return _.value.slice(a,s)});return(a,s)=>{const n=U("router-link");return c(),g("div",{class:"page-background content-scroller",onScroll:s[1]||(s[1]=(...m)=>k(f)&&k(f)(...m))},[t("div",null,[t("header",ue,[t("div",me,[t("div",ce,[u(n,{to:"/",class:"back-home-btn"},{default:r(()=>[t("span",pe,[u(w,{align:"center"},{zh:r(()=>[...s[2]||(s[2]=[i("回首頁",-1)])]),en:r(()=>[...s[3]||(s[3]=[i("Home",-1)])]),_:1})]),s[4]||(s[4]=t("span",{class:"icon"},"←",-1))]),_:1})]),s[6]||(s[6]=t("div",{class:"w-1/3 text-center"},[t("h1",{class:"text-2xl md:text-3xl font-bold"},"行動追蹤")],-1)),t("div",ge,[k(y)?(c(),R(n,{key:0,to:"/actions/new",title:"建立新故事"},{default:r(()=>[...s[5]||(s[5]=[t("div",{class:"w-10 h-10 bg-orange-300 rounded-full flex items-center justify-center text-white cursor-pointer transition delay-150 duration-300 ease-in-out hover:-translate-y-1 hover:scale-110"},[t("i",{class:"fa-solid fa-plus font-bold text-pblue-500"})],-1)])]),_:1})):T("",!0)])])]),t("main",xe,[u(z,{"onUpdate:filters":v,class:"flex flex-wrap justify-center items-center gap-4"}),u(re,{filteredInfo:$.value,class:"flex flex-col gap-10 w-full md:px-0"},null,8,["filteredInfo"]),_.value.length===0?(c(),g("div",fe,[...s[7]||(s[7]=[t("p",null,"找不到符合條件的行動。",-1)])])):T("",!0),u(de,{class:"flex justify-center items-center gap-4 mt-8",totalItems:_.value.length,itemsPerPage:h,modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=m=>l.value=m)},null,8,["totalItems","modelValue"]),u(G)])])],32)}}};export{De as default};
