import{_ as D,a as E,b as P,c as $,d as I,e as N,f as z,g as V,h as j,i as A,j as H,k as J,l as R,m as F,n as O,o as q,p as G,q as K,r as W,s as Q,t as X,u as Y,v as Z,w as ee}from"./平和國小_mobile_Example-DLfGNsGK.js";import{r as p,k as se,J as te,c as o,o as i,b as s,f as v,w as b,e as h,m as ae,n as le,t as r,F as k,d as w,a as f,h as n,g as c,E as oe,H as ie,p as ne}from"./index-7AOMyK3c.js";import{i as re}from"./Story-BaIknqfO.js";import{t as _e}from"./SDGs_goal-D1XSLY4x.js";import{_ as ue,C as de}from"./CJKSub-DtAg9oaQ.js";import{u as ge,i as ce,a as me,b as pe,E as ve}from"./index-CVl8IZer.js";const be={class:"pt-25 w-full z-10 shadow-md bg-header text-rice-500"},fe={class:"container mx-auto flex items-center p-4"},xe={class:"w-1/3"},he={class:"text"},ke={class:"max-w-4xl mx-auto p-4 pt-10 text-[1.2rem]"},we={key:0,class:"animate-fade-in-up flex flex-col gap-8"},ye={class:"relative z-10 text-white"},Ce={class:"text-4xl font-bold mb-4"},Be={class:"mb-2 text-lg"},Le={class:"flex flex-wrap gap-2 mt-2"},Se={class:"flex flex-col gap-4 items-start"},Me={class:"self-end flex gap-2"},Te=["innerHTML"],Ue={key:1,class:"w-full"},De={key:0,class:"border p-2 flex gap-2 rounded-t-md"},Ee={class:"my-20"},Pe={class:"flex flex-col gap-4 mb-6 text-black"},$e={class:"font-bold"},Ie={class:"text-gray-800"},Ne={class:"flex items-center justify-end mt-2"},ze=["onClick"],Ve={class:"ml-1"},je={key:1},Ae={__name:"StoryDetail",props:{id:String},setup(y){const C=y,x=ne("handleAppScroll"),a=p(re.find(_=>_.id===parseInt(C.id))),u=p(!1),B=se(()=>{if(!a.value)return{};const _=a.value.img_url||"Background_2.png";try{return{backgroundImage:`url(${new URL(Object.assign({"../assets/images/Background_1.png":ee,"../assets/images/Background_2.png":Z,"../assets/images/Bar_Selected.png":Y,"../assets/images/Bar_Unselected.png":X,"../assets/images/LoadingTrain.png":Q,"../assets/images/Logo.gif":W,"../assets/images/MainPage_Background.png":K,"../assets/images/MainPage_Background.webp":G,"../assets/images/MainPage_Example.png":q,"../assets/images/MainPage_Pic.png":O,"../assets/images/MainPage_Pic.webp":F,"../assets/images/Title.png":R,"../assets/images/figure1.png":J,"../assets/images/figure2.png":H,"../assets/images/figure3.png":A,"../assets/images/figure4.png":j,"../assets/images/figure5.png":V,"../assets/images/lightBulb.png":z,"../assets/images/lightBulb2.png":N,"../assets/images/logo.png":I,"../assets/images/logo_BW.png":$,"../assets/images/story_bg.png":P,"../assets/images/student.png":E,"../assets/images/平和國小_mobile_Example.png":D})[`../assets/images/${_}`],import.meta.url).href})`}}catch{return{backgroundImage:`url(${new URL("/Pinghe/assets/Background_2-C9DmGNh3.png",import.meta.url).href})`}}}),l=ge({content:"",extensions:[ce,me,pe.configure({nested:!0})]});te(()=>{l.value&&l.value.destroy()});const L=()=>{l.value&&l.value.commands.setContent(a.value.content||""),u.value=!0},S=()=>{l.value&&(a.value.content=l.value.getHTML()),u.value=!1,console.log(l.value.getJSON())},M=()=>{navigator.share?navigator.share({title:a.value.title,text:a.value.intro,url:window.location.href}).catch(console.error):(navigator.clipboard.writeText(window.location.href),alert("連結已複製到剪貼簿！"))},m={author_uuid:"0",author:"我"},d=p(""),T=()=>{d.value.trim()!==""&&(a.value.comment.unshift({uuid:Date.now(),author_uuid:m.author_uuid,author:m.author,time:Date.now(),delete_time:null,text:d.value,likes:0,liked:!1}),d.value="")},U=_=>{const e=a.value.comment.find(g=>g.uuid===_);e&&(e.liked?e.likes--:e.likes++,e.liked=!e.liked)};return(_,e)=>{const g=ae("router-link");return i(),o("div",{class:"page-background content-scroller",onScroll:e[3]||(e[3]=(...t)=>n(x)&&n(x)(...t))},[s("header",be,[s("div",fe,[s("div",xe,[v(g,{to:"/story",class:"back-home-btn"},{default:b(()=>[s("span",he,[v(de,{align:"center"},{zh:b(()=>[...e[4]||(e[4]=[h("回上頁",-1)])]),en:b(()=>[...e[5]||(e[5]=[h("Return",-1)])]),_:1})]),e[6]||(e[6]=s("span",{class:"icon"},"←",-1))]),_:1})]),e[7]||(e[7]=s("div",{class:"w-1/3 text-center"},null,-1)),e[8]||(e[8]=s("div",{class:"w-1/3"},null,-1))])]),s("main",ke,[a.value?(i(),o("section",we,[s("div",{style:le(B.value),class:"relative bg-cover bg-center bg-opacity-70 p-7 rounded-md md:h-80 grid grid-cols-1 content-end overflow-hidden"},[e[9]||(e[9]=s("div",{class:"absolute inset-0 bg-black/40"},null,-1)),s("div",ye,[s("h1",Ce,r(a.value.title),1),s("p",Be,r(a.value.intro),1),s("small",null,r(new Date(a.value.time*1e3).toLocaleDateString()),1),s("div",Le,[(i(!0),o(k,null,w(a.value.types,t=>(i(),o("span",{key:t,class:"px-3 py-1 text-sm rounded-full bg-blue-100 text-blue-800"},r(n(_e)[t].title),1))),128))])])],4),s("section",Se,[s("div",Me,[u.value?f("",!0):(i(),o("button",{key:0,onClick:L,class:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600"}," 編輯 ")),u.value?(i(),o("button",{key:1,onClick:S,class:"bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600"}," 儲存 ")):f("",!0),s("button",{onClick:M,class:"bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600"}," 分享 ")]),u.value?(i(),o("div",Ue,[n(l)?(i(),o("div",De,[s("button",{onClick:e[0]||(e[0]=t=>n(l).chain().focus().toggleTaskList().run()),class:c([{"bg-blue-200":n(l).isActive("taskList")},"p-2 rounded hover:bg-blue-200"]),title:"待辦清單"},[...e[10]||(e[10]=[s("i",{class:"fa-solid fa-list-check"},null,-1)])],2),s("button",{onClick:e[1]||(e[1]=t=>n(l).chain().focus().toggleBulletList().run()),class:c([{"bg-blue-200":n(l).isActive("bulletList")},"p-2 rounded hover:bg-blue-200"]),title:"項目符號清單"},[...e[11]||(e[11]=[s("i",{class:"fa-solid fa-list-ul"},null,-1)])],2)])):f("",!0),v(n(ve),{editor:n(l),class:"w-full prose max-w-none border-x border-b p-4 rounded-b-md"},null,8,["editor"])])):(i(),o("div",{key:0,class:"prose max-w-none",innerHTML:a.value.content},null,8,Te))]),s("section",Ee,[e[12]||(e[12]=s("h2",{class:"text-xl mb-4"},"留言板",-1)),s("div",Pe,[(i(!0),o(k,null,w(a.value.comment,t=>(i(),o("div",{key:t.uuid,class:c(["p-4 rounded-md",t.author_uuid===m.author_uuid?"bg-green-100":"bg-gray-100"])},[s("p",$e,r(t.author),1),s("p",Ie,r(t.text),1),s("div",Ne,[s("button",{onClick:He=>U(t.uuid),class:"text-gray-500 hover:text-red-500"},[s("i",{class:c(["fa-heart",t.liked?"fa-solid text-red-500":"fa-regular"])},null,2),s("span",Ve,r(t.likes),1)],8,ze)])],2))),128))]),s("div",null,[oe(s("textarea",{"onUpdate:modelValue":e[2]||(e[2]=t=>d.value=t),class:"w-full p-2 border rounded-md",rows:"3",placeholder:"在這裡寫下你的留言..."},null,512),[[ie,d.value]]),s("button",{onClick:T,class:"mt-2 bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600"}," 發布留言 ")])])])):(i(),o("div",je,[...e[13]||(e[13]=[s("p",null,"找不到這篇故事。",-1)])]))])],32)}}},Ke=ue(Ae,[["__scopeId","data-v-a7fbbe3e"]]);export{Ke as default};
