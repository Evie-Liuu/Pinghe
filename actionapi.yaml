openapi: 3.0.3
info:
  title: è¡Œå‹•ä»»å‹™å¡ç‰‡ API
  version: 2.0.0
  description: æä¾›æ´»å‹•ç®¡ç†èˆ‡ç•™è¨€äº’å‹•çš„çµ±ä¸€å›æ‡‰æ ¼å¼ API
  contact:
    name: API Support
    email: support@example.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: https://api.example.com/v1
    description: ç”Ÿç”¢ç’°å¢ƒ
  - url: https://api-staging.example.com/v1
    description: æ¸¬è©¦ç’°å¢ƒ

security:
  - bearerAuth: []

tags:
  - name: Activities
    description: æ´»å‹• CRUD æ“ä½œ
  - name: Activities verify
    description: æ´»å‹• CRUD åŠ å…¥è¡Œå‹•æ“ä½œ
  - name: Posts
    description: è²¼æ–‡ CRUD æ“ä½œ èˆ‡æŒ‰è®šåŠŸèƒ½
  - name: Comments
    description: ç•™è¨€ CRUD

paths:
  /activities:
    post:
      summary: æ–°å¢æ´»å‹•
      description: å»ºç«‹ä¸€å€‹æ–°çš„ä»»å‹™æ´»å‹•
      tags:
        - Activities
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ActivityCreate"
      responses:
        "201":
          description: æ´»å‹•å»ºç«‹æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
              examples:
                success:
                  value:
                    success: true
                    message: "æ´»å‹•å»ºç«‹æˆåŠŸ"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "422":
          $ref: "#/components/responses/ValidationError"
    get:
      summary: å–å¾—å…¨éƒ¨æ´»å‹•æ¸…å–® (ä½¿ç”¨è€…)
      description: æ”¯æ´åˆ†é ã€æ’åºå’Œç¯©é¸çš„æ´»å‹•æ¸…å–®æŸ¥è©¢
      tags:
        - Activities
      parameters:
        - $ref: "#/components/parameters/UserId"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/Limit"
        # - $ref: "#/components/parameters/Sort"
        - $ref: "#/components/parameters/Order"
        - name: title
          in: query
          description: ä¾æ¨™é¡Œç¯©é¸
          schema:
            type: string
        # - name: member
        #   in: query
        #   description: ä¾æˆå“¡ç¯©é¸
        #   schema:
        #     type: string
        - name: startDate
          in: query
          description: é–‹å§‹æ—¥æœŸç¯„åœï¼ˆæ ¼å¼ï¼šYYYY-MM-DDï¼‰
          schema:
            type: string
            format: date
        - name: endDate
          in: query
          description: çµæŸæ—¥æœŸç¯„åœï¼ˆæ ¼å¼ï¼šYYYY-MM-DDï¼‰
          schema:
            type: string
            format: date
      responses:
        "200":
          description: æ´»å‹•æ¸…å–®
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  content:
                    type: array
                    items:
                      $ref: "#/components/schemas/Activity"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /activities/{activityId}:
    get:
      summary: å–å¾—å–®ä¸€æ´»å‹•
      description: æ ¹æ“šæ´»å‹• ID å–å¾—æ´»å‹•è©³ç´°è³‡æ–™
      tags:
        - Activities
      parameters:
        - $ref: "#/components/parameters/ActivityId"
      responses:
        "200":
          description: æ´»å‹•è³‡æ–™
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  content:
                    $ref: "#/components/schemas/Activity"
        "404":
          $ref: "#/components/responses/NotFound"
        "401":
          $ref: "#/components/responses/Unauthorized"
    put:
      summary: ç·¨è¼¯æ´»å‹•
      description: æ›´æ–°æŒ‡å®šæ´»å‹•çš„è³‡æ–™
      tags:
        - Activities
      parameters:
        - $ref: "#/components/parameters/ActivityId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ActivityUpdate"
      responses:
        "200":
          description: æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
                examples:
                success:
                  value:
                    success: true
                    content:
                      message: "æ´»å‹•å·²å„²å­˜ç·¨è¼¯"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "422":
          $ref: "#/components/responses/ValidationError"
    delete:
      summary: åˆªé™¤æ´»å‹•
      description: æ°¸ä¹…åˆªé™¤æŒ‡å®šçš„æ´»å‹•
      tags:
        - Activities
      parameters:
        - $ref: "#/components/parameters/ActivityId"
      responses:
        "200":
          description: åˆªé™¤æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
              examples:
                success:
                  value:
                    success: true
                    content:
                      message: "æ´»å‹•å·²æˆåŠŸåˆªé™¤"
        "404":
          $ref: "#/components/responses/NotFound"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /activities/{activityId}/own:
    get:
      tags: [Activities]
      summary: å–å¾—è‡ªå·±çš„æ´»å‹•æ¸…å–®(å¯ç·¨è¼¯)
      parameters:
        - $ref: "#/components/parameters/UserId"
        - $ref: "#/components/parameters/ActivityId"
      responses:
        "200":
          description: è‡ªå·±çš„æ´»å‹•æ¸…å–®
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  content:
                    type: array
                    items:
                      type: integer
                    example: ["act_1", "act_2", "act_13"]

  /activities/{activityId}/join-requests:
    post:
      summary: æäº¤åŠ å…¥è«‹æ±‚
      description: ä½¿ç”¨è€…å°æ´»å‹•ç™¼é€åŠ å…¥è«‹æ±‚
      tags:
        - Activities verify
      parameters:
        - $ref: "#/components/parameters/ActivityId"
        - $ref: "#/components/parameters/UserId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                content:
                  $ref: "#/components/schemas/JoinRequestInput"
      responses:
        "201":
          description: åŠ å…¥è«‹æ±‚å·²å»ºç«‹
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  content:
                    $ref: "#/components/schemas/JoinRequest"
        "400":
          description: è«‹æ±‚æ ¼å¼éŒ¯èª¤
        "409":
          description: å·²ç¶“ç”³è«‹éæˆ–å·²åƒåŠ æ´»å‹•

    get:
      summary: ä¸»è¾¦æ–¹æŸ¥è©¢åŠ å…¥è«‹æ±‚
      description: ä¸»è¾¦æ–¹æŸ¥è©¢æŸæ´»å‹•æ‰€æœ‰åŠ å…¥è«‹æ±‚
      tags:
        - Activities verify
      parameters:
        - $ref: "#/components/parameters/ActivityId"
      responses:
        "200":
          description: æŸ¥è©¢æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JoinRequest"
        "403":
          description: ç„¡æ¬Šé™æ“ä½œ
        "404":
          description: æ´»å‹•ä¸å­˜åœ¨

  /activities/{activity_id}/join-requests/{userId}:
    post:
      summary: èˆ‰è¾¦æ–¹æ˜¯å¦æ¥å—åŠ å…¥è«‹æ±‚
      description: èˆ‰è¾¦æ–¹åŒæ„æˆ–æ‹’çµ•ç‰¹å®šä½¿ç”¨è€…åŠ å…¥æ´»å‹•
      tags:
        - Activities verify
      parameters:
        # - $ref: "#/components/parameters/RequestId"
        - $ref: "#/components/parameters/UserId"
        - name: approve
          in: query
          required: true
          description: æ˜¯å¦æ¥å—åŠ å…¥è«‹æ±‚
          schema:
            type: boolean
            example: true
      responses:
        "200":
          description: åŠ å…¥è«‹æ±‚å·²æ¥å—
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  content:
                    $ref: "#/components/schemas/JoinReult"
        "403":
          description: ç„¡æ¬Šé™æ“ä½œ
        "404":
          description: è«‹æ±‚ä¸å­˜åœ¨

  /institutions/{InstitutionId}/posts:
    get:
      summary: å–å¾—æ´»å‹•æ‰€æœ‰è²¼æ–‡
      description: æ ¹æ“šæ´»å‹• ID å–å¾—è²¼æ–‡æ¸…å–®
      tags:
        - Posts
      parameters:
        - $ref: "#/components/parameters/InstitutionId"
        - $ref: "#/components/parameters/rel_ActivityId"
      responses:
        "200":
          description: æ´»å‹•è³‡æ–™
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  content:
                    type: array
                    items:
                      $ref: "#/components/schemas/Post"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /institutions/{InstitutionId}/posts/{postId}:
    get:
      summary: å–å¾—å–®ä¸€è²¼æ–‡
      description: æ ¹æ“šæ´»å‹• ID å–å¾—æ´»å‹•è©³ç´°è³‡æ–™
      tags:
        - Posts
      parameters:
        - $ref: "#/components/parameters/InstitutionId"
        - $ref: "#/components/parameters/rel_ActivityId"
        - $ref: "#/components/parameters/PostId"
      responses:
        "200":
          description: æ´»å‹•è³‡æ–™
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  content:
                    $ref: "#/components/schemas/PostBase"
        "404":
          $ref: "#/components/responses/NotFound"
        "401":
          $ref: "#/components/responses/Unauthorized"
    put:
      summary: ç·¨è¼¯è²¼æ–‡
      description: æ›´æ–°æŒ‡å®šè²¼æ–‡çš„è³‡æ–™
      tags:
        - Posts
      parameters:
        - $ref: "#/components/parameters/InstitutionId"
        - $ref: "#/components/parameters/ActivityId"
        - $ref: "#/components/parameters/PostId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PostBase"
      responses:
        "200":
          description: æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
              examples:
                success:
                  value:
                    success: true
                    content:
                      message: "è²¼æ–‡å·²å„²å­˜ç·¨è¼¯"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "422":
          $ref: "#/components/responses/ValidationError"
    delete:
      summary: åˆªé™¤è²¼æ–‡
      description: æ°¸ä¹…åˆªé™¤æŒ‡å®šçš„è²¼æ–‡
      tags:
        - Posts
      parameters:
        - $ref: "#/components/parameters/InstitutionId"
        - $ref: "#/components/parameters/ActivityId"
        - $ref: "#/components/parameters/PostId"
      responses:
        "200":
          description: åˆªé™¤æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
              examples:
                success:
                  value:
                    success: true
                    content:
                      message: "æ´»å‹•å·²æˆåŠŸåˆªé™¤"
        "404":
          $ref: "#/components/responses/NotFound"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /institutions/{InstitutionId}/posts/{postId}/like:
    post:
      tags:
        - Posts
      summary: å°ç•™è¨€æ–°å¢è¡¨æƒ…åæ‡‰
      security:
        - bearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ActivityId"
        - $ref: "#/components/parameters/PostId"
        - $ref: "#/components/parameters/UserId"
      responses:
        "200":
          description: æ–°å¢è¡¨æƒ…åæ‡‰æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  content:
                    $ref: "#/components/schemas/Post"
    delete:
      tags: [Posts]
      summary: å–æ¶ˆå°ç•™è¨€è¡¨æƒ…åæ‡‰
      security:
        - bearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ActivityId"
        - $ref: "#/components/parameters/PostId"
        - $ref: "#/components/parameters/UserId"
      responses:
        "200":
          description: å–æ¶ˆè¡¨æƒ…åæ‡‰æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  content:
                    $ref: "#/components/schemas/Post"

  /institutions/{InstitutionId}/posts/{postId}/comments:
    post:
      summary: ç™¼è¡¨ç•™è¨€
      description: åœ¨æŒ‡å®šè²¼æ–‡ä¸‹æ–°å¢ç•™è¨€
      tags:
        - Comments
      parameters:
        - $ref: "#/components/parameters/InstitutionId"
        - $ref: "#/components/parameters/ActivityId"
        - $ref: "#/components/parameters/PostId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CommentCreate"
      responses:
        "201":
          description: ç•™è¨€ç™¼è¡¨æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
              examples:
                success:
                  value:
                    success: true
                    content:
                      message: "ç•™è¨€å·²æˆåŠŸç™¼è¡¨"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "422":
          $ref: "#/components/responses/ValidationError"
    get:
      summary: å–å¾—è²¼æ–‡ç•™è¨€æ¸…å–®
      description: æ”¯æ´åˆ†é çš„ç•™è¨€æ¸…å–®æŸ¥è©¢
      tags:
        - Comments
      parameters:
        - $ref: "#/components/parameters/InstitutionId"
        - $ref: "#/components/parameters/ActivityId"
        - $ref: "#/components/parameters/PostId"
        # - $ref: "#/components/parameters/Page"
        # - $ref: "#/components/parameters/Limit"
        # - $ref: "#/components/parameters/Sort"
        # - $ref: "#/components/parameters/Order"
      responses:
        "200":
          description: ç•™è¨€æ¸…å–®
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  content:
                    type: array
                    items:
                      $ref: "#/components/schemas/Comment"
        "404":
          $ref: "#/components/responses/NotFound"
        "401":
          $ref: "#/components/responses/Unauthorized"

  # /institutions/{InstitutionId}/comments/{commentId}:
  #   put:
  #     summary: ç·¨è¼¯ç•™è¨€
  #     description: æ›´æ–°æŒ‡å®šç•™è¨€çš„å…§å®¹
  #     tags:
  #       - Comments
  #     parameters:
  #       - $ref: "#/components/parameters/ActivityId"
  #       - $ref: "#/components/parameters/CommentId"
  #     requestBody:
  #       required: true
  #       content:
  #         application/json:
  #           schema:
  #             $ref: "#/components/schemas/CommentUpdate"
  #     responses:
  #       "200":
  #         description: ç•™è¨€æ›´æ–°æˆåŠŸ
  #         content:
  #           application/json:
  #             schema:
  #               $ref: "#/components/schemas/SuccessResponse"
  #       "400":
  #         $ref: "#/components/responses/BadRequest"
  #       "404":
  #         $ref: "#/components/responses/NotFound"
  #       "401":
  #         $ref: "#/components/responses/Unauthorized"
  #       "403":
  #         $ref: "#/components/responses/Forbidden"
  #       "422":
  #         $ref: "#/components/responses/ValidationError"
  #   delete:
  #     summary: åˆªé™¤ç•™è¨€
  #     description: æ°¸ä¹…åˆªé™¤æŒ‡å®šçš„ç•™è¨€
  #     tags:
  #       - Comments
  #     parameters:
  #       - $ref: "#/components/parameters/ActivityId"
  #       - $ref: "#/components/parameters/CommentId"
  #     responses:
  #       "200":
  #         description: åˆªé™¤æˆåŠŸ
  #         content:
  #           application/json:
  #             schema:
  #               $ref: "#/components/schemas/SuccessResponse"
  #             examples:
  #               success:
  #                 value:
  #                   success: true
  #                   content:
  #                     message: "ç•™è¨€å·²æˆåŠŸåˆªé™¤"
  #       "404":
  #         $ref: "#/components/responses/NotFound"
  #       "401":
  #         $ref: "#/components/responses/Unauthorized"
  #       "403":
  #         $ref: "#/components/responses/Forbidden"

  # /institutions/{InstitutionId}/comments/{commentId}/replies:
  #   post:
  #     summary: å›è¦†ç•™è¨€
  #     description: å°æŒ‡å®šç•™è¨€é€²è¡Œå›è¦†
  #     tags:
  #       - Replies
  #     parameters:
  #       - $ref: "#/components/parameters/ActivityId"
  #       - $ref: "#/components/parameters/CommentId"
  #     requestBody:
  #       required: true
  #       content:
  #         application/json:
  #           schema:
  #             $ref: "#/components/schemas/ReplyCreate"
  #     responses:
  #       "201":
  #         description: å›è¦†æˆåŠŸ
  #         content:
  #           application/json:
  #             schema:
  #               $ref: "#/components/schemas/SuccessResponse"
  #             examples:
  #               success:
  #                 value:
  #                   success: true
  #                   content:
  #                     id: "reply_001"
  #                     content: "æˆ‘åŒæ„é€™å€‹æƒ³æ³•ï¼"
  #                     author: "user2"
  #                     created_at: "2024-01-15T10:45:00Z"
  #       "400":
  #         $ref: "#/components/responses/BadRequest"
  #       "404":
  #         $ref: "#/components/responses/NotFound"
  #       "401":
  #         $ref: "#/components/responses/Unauthorized"
  #       "422":
  #         $ref: "#/components/responses/ValidationError"
  #   get:
  #     summary: å–å¾—å›è¦†æ¸…å–®
  #     description: æ”¯æ´åˆ†é çš„å›è¦†æ¸…å–®æŸ¥è©¢
  #     tags:
  #       - Replies
  #     parameters:
  #       - $ref: "#/components/parameters/ActivityId"
  #       - $ref: "#/components/parameters/CommentId"
  #       - $ref: "#/components/parameters/Page"
  #       - $ref: "#/components/parameters/Limit"
  #     responses:
  #       "200":
  #         description: å›è¦†æ¸…å–®
  #         content:
  #           application/json:
  #             schema:
  #               $ref: "#/components/schemas/PaginatedResponse"
  #       "404":
  #         $ref: "#/components/responses/NotFound"
  #       "401":
  #         $ref: "#/components/responses/Unauthorized"

  # /institutions/{InstitutionId}/comments/{commentId}/reactions:
  #   post:
  #     summary: æ–°å¢è¡¨æƒ…åæ‡‰
  #     description: å°æŒ‡å®šç•™è¨€æ–°å¢è¡¨æƒ…åæ‡‰
  #     tags:
  #       - Reactions
  #     parameters:
  #       - $ref: "#/components/parameters/ActivityId"
  #       - $ref: "#/components/parameters/CommentId"
  #     requestBody:
  #       required: true
  #       content:
  #         application/json:
  #           schema:
  #             $ref: "#/components/schemas/ReactionCreate"
  #     responses:
  #       "201":
  #         description: è¡¨æƒ…æ–°å¢æˆåŠŸ
  #         content:
  #           application/json:
  #             schema:
  #               $ref: "#/components/schemas/SuccessResponse"
  #             examples:
  #               success:
  #                 value:
  #                   success: true
  #                   content:
  #                     emoji: "ğŸ‘"
  #                     user: "user1"
  #                     created_at: "2024-01-15T10:50:00Z"
  #       "400":
  #         $ref: "#/components/responses/BadRequest"
  #       "404":
  #         $ref: "#/components/responses/NotFound"
  #       "401":
  #         $ref: "#/components/responses/Unauthorized"
  #       "409":
  #         $ref: "#/components/responses/Conflict"
  #   delete:
  #     summary: å–æ¶ˆè¡¨æƒ…åæ‡‰
  #     description: ç§»é™¤æŒ‡å®šç•™è¨€çš„è¡¨æƒ…åæ‡‰
  #     tags:
  #       - Reactions
  #     parameters:
  #       - $ref: "#/components/parameters/ActivityId"
  #       - $ref: "#/components/parameters/CommentId"
  #       - name: emoji
  #         in: query
  #         required: true
  #         description: è¦ç§»é™¤çš„è¡¨æƒ…ç¬¦è™Ÿ
  #         schema:
  #           type: string
  #     responses:
  #       "200":
  #         description: è¡¨æƒ…ç§»é™¤æˆåŠŸ
  #         content:
  #           application/json:
  #             schema:
  #               $ref: "#/components/schemas/SuccessResponse"
  #             examples:
  #               success:
  #                 value:
  #                   success: true
  #                   content:
  #                     message: "è¡¨æƒ…åæ‡‰å·²ç§»é™¤"
  #       "404":
  #         $ref: "#/components/responses/NotFound"
  #       "401":
  #         $ref: "#/components/responses/Unauthorized"

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  parameters:
    UserId:
      name: userId
      in: query
      required: true
      description: ä½¿ç”¨è€…çš„å”¯ä¸€è­˜åˆ¥ç¢¼
      schema:
        type: string
        example: 1

    InstitutionId:
      name: institutionId
      in: path
      required: true
      description: æ©Ÿæ§‹çš„å”¯ä¸€è­˜åˆ¥ç¢¼
      schema:
        type: string
        example: 123

    ActivityId:
      name: activityId
      in: path
      required: true
      description: æ´»å‹•çš„å”¯ä¸€è­˜åˆ¥ç¢¼
      schema:
        type: string
        pattern: "^act_[a-zA-Z0-9]+$"
        example: act_123

    rel_ActivityId:
      name: related_activity_id
      in: query
      required: true
      description: æ´»å‹•çš„å”¯ä¸€è­˜åˆ¥ç¢¼
      schema:
        type: string
        example: act_123

    PostId:
      name: postId
      in: path
      required: true
      description: ä»»å‹™çš„å”¯ä¸€è­˜åˆ¥ç¢¼
      schema:
        type: string
        # pattern: "^act_[a-zA-Z0-9]+$"
        example: post_123

    CommentId:
      name: commentId
      in: path
      required: true
      description: ç•™è¨€çš„å”¯ä¸€è­˜åˆ¥ç¢¼
      schema:
        type: string
        pattern: "^cmt_[a-zA-Z0-9]+$"
        example: cmt_001

    RequestId:
      name: requestId
      in: path
      required: true
      description: åŠ å…¥è¡Œå‹•è«‹æ±‚çš„å”¯ä¸€è­˜åˆ¥ç¢¼
      schema:
        type: string
        example: req_001

    Page:
      name: page
      in: query
      description: é æ•¸ï¼ˆå¾ 1 é–‹å§‹ï¼‰
      schema:
        type: integer
        minimum: 1
        default: 1
        example: 1

    Limit:
      name: limit
      in: query
      description: æ¯é é …ç›®æ•¸é‡
      schema:
        type: integer
        minimum: 1
        maximum: 3
        default: 3
        example: 3

    Sort:
      name: sort
      in: query
      description: æ’åºæ¬„ä½
      schema:
        type: string
        enum: [created_at, updated_at, title, author]
        default: created_at

    Order:
      name: order
      in: query
      description: æ’åºæ–¹å‘
      schema:
        type: string
        enum: [asc, desc]
        default: desc

  responses:
    BadRequest:
      description: è«‹æ±‚åƒæ•¸éŒ¯èª¤
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          examples:
            badRequest:
              value:
                success: false
                error:
                  code: "BAD_REQUEST"
                  message: "è«‹æ±‚åƒæ•¸æ ¼å¼éŒ¯èª¤"
                  details: "ç„¡æ•ˆçš„æ—¥æœŸæ ¼å¼"

    Unauthorized:
      description: æœªæˆæ¬Šè¨ªå•
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          examples:
            unauthorized:
              value:
                success: false
                error:
                  code: "UNAUTHORIZED"
                  message: "è«‹å…ˆç™»å…¥ä»¥è¨ªå•æ­¤è³‡æº"

    Forbidden:
      description: ç¦æ­¢è¨ªå•
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          examples:
            forbidden:
              value:
                success: false
                error:
                  code: "FORBIDDEN"
                  message: "æ‚¨æ²’æœ‰æ¬Šé™åŸ·è¡Œæ­¤æ“ä½œ"

    NotFound:
      description: è³‡æºä¸å­˜åœ¨
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          examples:
            notFound:
              value:
                success: false
                error:
                  code: "NOT_FOUND"
                  message: "æ‰¾ä¸åˆ°æŒ‡å®šçš„è³‡æº"

    Conflict:
      description: è³‡æºè¡çª
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          examples:
            conflict:
              value:
                success: false
                error:
                  code: "CONFLICT"
                  message: "è³‡æºå·²å­˜åœ¨æˆ–æ“ä½œè¡çª"

    ValidationError:
      description: è³‡æ–™é©—è­‰éŒ¯èª¤
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ValidationErrorResponse"
          examples:
            validation:
              value:
                success: false
                error:
                  code: "VALIDATION_ERROR"
                  message: "è³‡æ–™é©—è­‰å¤±æ•—"
                  fields:
                    title: ["æ¨™é¡Œä¸èƒ½ç‚ºç©º"]
                    start_time: ["é–‹å§‹æ™‚é–“å¿…é ˆæ™šæ–¼ç•¶å‰æ™‚é–“"]

    InternalServerError:
      description: ä¼ºæœå™¨å…§éƒ¨éŒ¯èª¤
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          examples:
            serverError:
              value:
                success: false
                error:
                  code: "INTERNAL_SERVER_ERROR"
                  message: "ä¼ºæœå™¨å…§éƒ¨éŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦"

  schemas:
    # çµ±ä¸€å›æ‡‰æ ¼å¼
    BaseResponse:
      type: object
      required: [success]
      properties:
        success:
          type: boolean
          description: æ“ä½œæ˜¯å¦æˆåŠŸ
        # timestamp:
        #   type: string
        #   format: date-time
        #   description: å›æ‡‰æ™‚é–“æˆ³
        #   example: "2025-07-05T09:00:00"

    SuccessResponse:
      allOf:
        - $ref: "#/components/schemas/BaseResponse"
        - type: object
          properties:
            success:
              type: boolean
              enum: [true]
            content:
              description: æˆåŠŸå›æ‡‰çš„è³‡æ–™å…§å®¹
              type: object

    ErrorResponse:
      allOf:
        - $ref: "#/components/schemas/BaseResponse"
        - type: object
          properties:
            success:
              type: boolean
              enum: [false]
            error:
              type: object
              required: [code, message]
              properties:
                code:
                  type: string
                  description: éŒ¯èª¤ä»£ç¢¼
                  example: "VALIDATION_ERROR"
                message:
                  type: string
                  description: éŒ¯èª¤è¨Šæ¯
                  example: "è³‡æ–™é©—è­‰å¤±æ•—"
                details:
                  type: string
                  description: è©³ç´°éŒ¯èª¤èªªæ˜
                  example: "æ¨™é¡Œæ¬„ä½ä¸èƒ½ç‚ºç©º"

    ValidationErrorResponse:
      allOf:
        - $ref: "#/components/schemas/ErrorResponse"
        - type: object
          properties:
            error:
              type: object
              required: [code, message, fields]
              properties:
                code:
                  type: string
                  enum: ["VALIDATION_ERROR"]
                message:
                  type: string
                  example: "è³‡æ–™é©—è­‰å¤±æ•—"
                fields:
                  type: object
                  description: æ¬„ä½é©—è­‰éŒ¯èª¤è©³æƒ…
                  additionalProperties:
                    type: array
                    items:
                      type: string
                  example:
                    title: ["æ¨™é¡Œä¸èƒ½ç‚ºç©º", "æ¨™é¡Œé•·åº¦å¿…é ˆä»‹æ–¼ 1-100 å­—å…ƒ"]
                    email: ["è«‹è¼¸å…¥æœ‰æ•ˆçš„é›»å­éƒµä»¶åœ°å€"]

    PaginatedResponse:
      allOf:
        - $ref: "#/components/schemas/SuccessResponse"
        - type: object
          properties:
            content:
              type: object
              required: [data, pagination]
              properties:
                data:
                  type: array
                  description: è³‡æ–™é™£åˆ—
                  items:
                    type: object
                pagination:
                  $ref: "#/components/schemas/Pagination"

    Pagination:
      type: object
      required: [page, limit, total, totalPages, hasNext, hasPrev]
      properties:
        page:
          type: integer
          description: ç•¶å‰é æ•¸
          minimum: 1
          example: 1
        limit:
          type: integer
          description: æ¯é é …ç›®æ•¸é‡
          minimum: 1
          example: 20
        total:
          type: integer
          description: ç¸½é …ç›®æ•¸
          minimum: 0
          example: 100
        totalPages:
          type: integer
          description: ç¸½é æ•¸
          minimum: 0
          example: 5
        hasNext:
          type: boolean
          description: æ˜¯å¦æœ‰ä¸‹ä¸€é 
          example: true
        hasPrev:
          type: boolean
          description: æ˜¯å¦æœ‰ä¸Šä¸€é 
          example: false

    # æ´»å‹•ç›¸é—œ Schema
    ActivityBase:
      type: object
      required: [title, start_time, end_time]
      properties:
        title:
          type: string
          minLength: 1
          maxLength: 100
          description: æ´»å‹•æ¨™é¡Œ
          example: "å‰©é£Ÿå•é¡Œ"
        description:
          type: string
          maxLength: 1000
          description: æ´»å‹•æè¿°
          example: "æš«ç„¡æè¿°"
        start_time:
          type: string
          format: date-time
          description: æ´»å‹•é–‹å§‹æ™‚é–“
          example: "2025-07-05T09:00:00"
        end_time:
          type: string
          format: date-time
          description: æ´»å‹•çµæŸæ™‚é–“
          example: "2025-10-05T09:00:00"
        types:
          type: array
          description: æ´»å‹•SGDsé¡å‹
          example: [2, 4, 13]

    ActivityCreate:
      allOf:
        - $ref: "#/components/schemas/ActivityBase"
        - $ref: "#/components/schemas/StageCreate"

    ActivityUpdate:
      allOf:
        - $ref: "#/components/schemas/ActivityBase"
        - $ref: "#/components/schemas/StageCreate"
        - type: object
          # required: [members]
          properties:
            members:
              type: array
              items:
                type: string
              example: ["user1", "user2", "user3"]

    Activity:
      allOf:
        - $ref: "#/components/schemas/ActivityBase"
        - type: object
          required: [id, created_at, updated_at]
          properties:
            id:
              type: string
              # pattern: "^act_[a-zA-Z0-9]+$"
              description: æ´»å‹•å”¯ä¸€è­˜åˆ¥ç¢¼
              example: "act_123"
            user_id:
              type: string
              description: æ´»å‹•å”¯ä¸€è­˜åˆ¥ç¢¼
              example: "1"
            progresss_percentage:
              type: number
              minimum: 0
              maximum: 100
              description: é€²åº¦ç™¾åˆ†æ¯”
              example: 100
            created_at:
              type: string
              format: date-time
              description: å»ºç«‹æ™‚é–“
              example: "2025-07-05T09:00:00"
            updated_at:
              type: string
              format: date-time
              description: æœ€å¾Œæ›´æ–°æ™‚é–“
              example: "2025-10-05T09:00:00"
            stages:
              type: array
              description: æ´»å‹•éšæ®µåˆ—è¡¨
              items:
                $ref: "#/components/schemas/Stage"
            allowed_join_open:
              type: boolean
              description: æ˜¯å¦å…è¨±è‡ªç”±åŠ å…¥æ´»å‹•
              example: false
            joined_by_user:
              type: boolean
              description: æ˜¯å¦å·²åŠ å…¥æ´»å‹• #å­¸ç”Ÿèº«åˆ†(-1: æœªåŠ å…¥; 0:ç”³è«‹åŠ å…¥; 1:å·²åŠ å…¥;)
              example: -1
            members:
              type: array
              items:
                type: string
              minItems: 1
              maxItems: 50
              description: åƒèˆ‡æˆå“¡åˆ—è¡¨
              example: ["user1", "user2", "user3"]
            posts:
              $ref: "#/components/schemas/Post"
            comments:
              $ref: "#/components/schemas/Comment"

    # åŠ å…¥è«‹æ±‚ç›¸é—œ Schema
    JoinRequestInput:
      type: object
      required: [user_id]
      properties:
        user_id:
          type: string
          example: "23"

    JoinReult:
      description: å›å¾©è«‹æ±‚å¾Œåˆ—è¡¨
      type: object
      properties:
        request_list:
          type: array
          description: ç­‰å¾…å›å¾©è«‹æ±‚åˆ—è¡¨
          items:
            type: object
            required: [user_id, time]
            properties:
              user_id:
                type: string
                example: "22"
              time:
                type: string
                example: "2025-09-11T09:00:00"
        rejected_list:
          type: array
          description: æ‹’çµ•è«‹æ±‚åˆ—è¡¨
          items:
            type: object
            required: [user_id, time]
            properties:
              user_id:
                type: string
                example: "24"
              time:
                type: string
                example: "2025-09-20T09:00:00"

    JoinRequest:
      description: åŠ å…¥è«‹æ±‚åˆ—è¡¨
      type: object
      # required: [id, user_id, time]
      properties:
        request_list:
          type: array
          description: ç­‰å¾…å›å¾©è«‹æ±‚åˆ—è¡¨
          items:
            type: object
            required: [user_id, time]
            properties:
              user_id:
                type: string
                example: "22"
              time:
                type: string
                example: "2025-09-11T09:00:00"
        rejected_list:
          type: array
          description: æ‹’çµ•è«‹æ±‚åˆ—è¡¨
          items:
            type: object
            required: [user_id, time]
            properties:
              user_id:
                type: string
                example: "24"
              time:
                type: string
                example: "2025-09-20T09:00:00"
      # example:
      #   - id: "req_001"
      #     user_id: "user_123"
      #     time: "1783977600"
      #   - id: "req_002"
      #     user_id: "user_456"
      #     time: "1783981200"

    # éšæ®µç›¸é—œ Schema
    StageBase:
      type: object
      required: [order, name, start_time, end_time]
      properties:
        order:
          type: integer
          description: éšæ®µé †åº
          example: 1
        name:
          type: string
          description: éšæ®µåç¨±
          example: è¡Œå‹•è¦åŠƒ
        completed:
          type: boolean
          description: éšæ®µå®Œæˆåº¦
          example: true
        start_time:
          type: string
          format: date-time
          description: é–‹å§‹æ™‚é–“
          example: "2025-07-05T09:00:00"
        end_time:
          type: string
          format: date-time
          description: çµæŸæ™‚é–“
          example: "2025-10-05T09:00:00"

    StageCreate:
      type: object
      required: [stages]
      properties:
        stages:
          type: array
          description: æ´»å‹•éšæ®µåˆ—è¡¨
          items:
            $ref: "#/components/schemas/StageBase"

    Stage:
      allOf:
        - $ref: "#/components/schemas/StageBase"
        - type: object
          required: [id, created_at, updated_at]
          properties:
            # id:
            #   type: string
            #   pattern: "^stage_[a-zA-Z0-9]+$"
            #   description: éšæ®µå”¯ä¸€è­˜åˆ¥ç¢¼
            #   example: "stage_001"
            created_at:
              type: string
              format: date-time
              description: å»ºç«‹æ™‚é–“
              example: "2025-07-05T09:00:00"
            updated_at:
              type: string
              format: date-time
              description: æœ€å¾Œæ›´æ–°æ™‚é–“
              example: "2025-10-05T09:00:00"

    # ä»»å‹™ç›¸é—œ Schema
    PostBase:
      type: object
      required: [content, stage, allowed_comment]
      properties:
        id:
          type: string
          description: ä»»å‹™å”¯ä¸€è­˜åˆ¥ç¢¼
          example: "post_123"
        user_id:
          type: string
          description: ä½œè€…è­˜åˆ¥ç¢¼
          example: "user1"
        content:
          type: string
          example: <p>å‰©é£Ÿå•é¡Œèª¿æŸ¥</p>
        stage:
          type: integer
          example: 1
        allowed_comment:
          type: boolean
          example: true

    Post:
      type: array
      description: ä»»å‹™åˆ—è¡¨
      items:
        allOf:
          - $ref: "#/components/schemas/PostBase"
          - type: object
            required:
              [id, author, created_at, updated_at, reactions, replyCount]
            properties:
              created_at:
                type: string
                format: date-time
                description: å»ºç«‹æ™‚é–“
                example: "2025-07-05T09:00:00"
              updated_at:
                type: string
                format: date-time
                description: æœ€å¾Œæ›´æ–°æ™‚é–“
                example: "2025-10-05T09:00:00"
              replies_count:
                type: integer
                example: 0
              reactions_count:
                type: integer
                example: 5
              reactions:
                type: object
                properties:
                  like:
                    type: integer
                    example: 3
                  laugh:
                    type: integer
                    example: 2
              liked_by_user:
                type: string
                example: laugh
              img_path:
                type: string
                example: images/[post_id]/
              file_path:
                type: string
                example: files/[post_id]/

    # ç•™è¨€ç›¸é—œ Schema
    CommentBase:
      type: object
      required: [content]
      properties:
        id:
          type: string
          example: "cmt_01"
        user_id:
          type: string
          example: "01"
        content:
          type: string
          minLength: 1
          maxLength: 2000
          description: ç•™è¨€å…§å®¹
          example: "<p>æŒ‘é£Ÿç‹€æ³è »æ˜é¡¯çš„</p>"

    CommentCreate:
      $ref: "#/components/schemas/CommentBase"

    CommentUpdate:
      $ref: "#/components/schemas/CommentBase"

    Comment:
      allOf:
        - $ref: "#/components/schemas/CommentBase"
        - type: object
          required: [id, author, created_at, updated_at, reactions, replyCount]
          properties:
            parent_id:
              type: string
              example: "post_123"
            created_at:
              type: string
              format: date-time
              description: å»ºç«‹æ™‚é–“
              example: "2025-07-05T09:00:00"
            updated_at:
              type: string
              format: date-time
              description: æœ€å¾Œæ›´æ–°æ™‚é–“
              example: "1748877600"
            # reactions:
            #   type: array
            #   description: è¡¨æƒ…åæ‡‰çµ±è¨ˆ
            #   items:
            #     $ref: "#/components/schemas/ReactionSummary"
            # replyCount:
            #   type: integer
            #   minimum: 0
            #   description: å›è¦†æ•¸é‡
            #   example: 3

    # å›è¦†ç›¸é—œ Schema
    ReplyBase:
      type: object
      required: [content]
      properties:
        content:
          type: string
          minLength: 1
          maxLength: 1000
          description: å›è¦†å…§å®¹
          example: "æˆ‘åŒæ„é€™å€‹æƒ³æ³•ï¼Œè®“æˆ‘å€‘é–‹å§‹åŸ·è¡Œå§ï¼"

    ReplyCreate:
      $ref: "#/components/schemas/ReplyBase"

    ReplyUpdate:
      $ref: "#/components/schemas/ReplyBase"

    Reply:
      allOf:
        - $ref: "#/components/schemas/ReplyBase"
        - type: object
          required: [id, author, created_at, updated_at]
          properties:
            id:
              type: string
              pattern: "^reply_[a-zA-Z0-9]+$"
              description: å›è¦†å”¯ä¸€è­˜åˆ¥ç¢¼
              example: "reply_001"
            author:
              type: string
              description: ä½œè€…è­˜åˆ¥ç¢¼
              example: "user2"
            created_at:
              type: string
              format: date-time
              description: å»ºç«‹æ™‚é–“
              example: "2024-01-15T10:45:00Z"
            updated_at:
              type: string
              format: date-time
              description: æœ€å¾Œæ›´æ–°æ™‚é–“
              example: "2024-01-15T10:45:00Z"

    # è¡¨æƒ…åæ‡‰ç›¸é—œ Schema
    ReactionCreate:
      type: object
      required: [emoji]
      properties:
        emoji:
          type: string
          minLength: 1
          maxLength: 10
          description: è¡¨æƒ…ç¬¦è™Ÿï¼ˆåƒ…æ”¯æ´ Unicode emojiï¼‰
          example: "ğŸ‘"

    ReactionSummary:
      type: object
      required: [emoji, count]
      properties:
        emoji:
          type: string
          description: è¡¨æƒ…ç¬¦è™Ÿ
          example: "ğŸ‘"
        count:
          type: integer
          minimum: 1
          description: è©²è¡¨æƒ…çš„æ•¸é‡
          example: 5
        users:
          type: array
          description: ä½¿ç”¨è©²è¡¨æƒ…çš„ç”¨æˆ¶åˆ—è¡¨ï¼ˆå¯é¸ï¼‰
          items:
            type: string
          example: ["user1", "user2", "user3"]
